/* `webpack.config.dist.min` should be used to statically build the a minified version of the distributed library files. */

const fs = require('fs');
const webpack = require('webpack');
const StringReplacePlugin = require('string-replace-webpack-plugin');
const packageJson = require('./package.json');
const header = packageJson.name + '\n' + 'v' + packageJson.version + '\n';
const license = fs.readFileSync('./LICENSE', 'utf8');
const baseConfig = require('./webpack.config.dist');

const config = baseConfig;
config.plugins = [
	new StringReplacePlugin(),
	new webpack.optimize.UglifyJsPlugin({
		mangle: {
			except: ['$', 'exports', 'require']
		}
	}),
	new webpack.BannerPlugin(header + license)
];

config.output.filename = '[name].min.js';	// [name] is config.entry object keys

module.exports = config;
